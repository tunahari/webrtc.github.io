# ğŸ“¡ HÆ°á»›ng dáº«n cháº¡y test WebRTC local vá»›i Docker + Coturn
## file `.env` lÃ  file báº£o máº­t thÃ´ng tin, hÃ£y thÃªm vÃ o `.gitignore` náº¿u cÃ³ commit
---------------------------------------------
## âš™ï¸ YÃªu cáº§u
- CÃ i Ä‘áº·t [Node.js](https://nodejs.org/)
- Cháº¡y `npm install` trong thÆ° má»¥c `server/`

---------------------------------------------

## ğŸ§ª BÆ°á»›c 1: TÃ¬m IP ná»™i bá»™ (IP dÃ¹ng Ä‘á»ƒ cáº¥u hÃ¬nh TURN server)

### TrÃªn Windows:
- bash(cmd): `ipconfig`

- TÃ¬m `IPv4 Address`, vÃ­ dá»¥: `192.168.2.15`

### TrÃªn Linux:
- bash(ubuntu): `ip a`

- TÃ¬m `inet` trong pháº§n chá»©a `BROADCAST, MULTICAST`, vÃ­ dá»¥: `172.18.254.133/20`
- Ip cáº§n tÃ¬m lÃ : `172.18.254.133`
---------------------------------------------

## ğŸ› ï¸ BÆ°á»›c 2: Cáº¥u hÃ¬nh Coturn

- Má»Ÿ file: `.env`
- Thay Ä‘á»•i
     `ALLOWED_PEER_IP={IP ná»™i bá»™}`
    vÃ­ dá»¥: `ALLOWED_PEER_IP=192.168.x.x`  # (hoáº·c IP ná»™i bá»™ báº¡n vá»«a tÃ¬m)

> âš ï¸ Náº¿u chá»‰ test local, giá»¯ nguyÃªn `EXTERNAL_IP` vÃ  `RELAY_IP` lÃ  `127.0.0.1`

- âš ï¸ Cá»•ng cá»§a server vÃ  cá»•ng cá»§a Turn lÃ  2 cá»•ng khÃ¡c nhau
- âš ï¸ Thay Ä‘á»•i cá»•ng khÃ¡c náº¿u cá»•ng bá»‹ cháº·n trÃªn thiáº¿t bá»‹
---------------------------------------------

## ğŸš€ BÆ°á»›c 3: Khá»Ÿi cháº¡y server.
- Khá»Ÿi cháº¡y Docker Desktop (Aplication)
- Build má»›i compose docker
- bash: `docker compose up -d --build`

Náº¿u thÃ nh cÃ´ng, terminal sáº½ bÃ¡o:
```
âœ” Container coturn Started
âœ” Container server Started
```
- Cáº£ 2 container pháº£i á»Ÿ tráº¡ng thÃ¡i Started 

---------------------------------------------

## ğŸ§ª BÆ°á»›c 4: Kiá»ƒm tra TURN server hoáº¡t Ä‘á»™ng

- Truy cáº­p: [Trickle ICE](https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/) 

Nháº­p thÃ´ng tin:

- STUN or TURN URI: turn:`<IP ná»™i bá»™>`:`<TURN_PORT>` vd: `turn:127.0.0.1:3478`
- TURN username: `<TURN_USER>` vd: `turnuser`
- TURN password: `<TURN_PASSWORD>` vd: `turnpassword`

ğŸ‘‰ ThÃ´ng tin nÃ y láº¥y trong `.env`

- Nháº¥n **Gather candidates**  
âœ… Náº¿u báº¡n tháº¥y dÃ²ng `relayProtocol` tráº£ vá»: `udp` hoáº·c `tcp` thÃ¬ TURN hoáº¡t Ä‘á»™ng thÃ nh cÃ´ng.


---------------------------------------------

## ğŸ¬ BÆ°á»›c 5: Cháº¡y thá»­ giao diá»‡n

- Má»Ÿ `public/index.html` trong trÃ¬nh duyá»‡t vÃ  hiá»ƒn thá»‹ `Káº¿t ná»‘i Ä‘áº¿n mÃ¡y chá»§ thÃ nh cÃ´ng!`
- Má»Ÿ DevTools (F12) â†’ tab Console  â†’  `ICE servers Ä‘Æ°á»£c láº¥y thÃ nh cÃ´ng:`
- Kiá»ƒm tra xem ICE server tráº£ vá» Ä‘Ãºng TURN chÆ°a
- Náº¿u tráº£ vá» TURN dá»± phÃ²ng thÃ¬ pháº£i xem láº¡i cáº¥u hÃ¬nh TURN.

---------------------------------------------

# â˜ï¸ HÆ°á»›ng dáº«n triá»ƒn khai WebRTC trÃªn VPS (Public IP)

## ğŸŒ BÆ°á»›c 1: Láº¥y Public IP cá»§a VPS

Truy cáº­p: [whatismyip.com](https://www.whatismyip.com/) vÃ  coppy: My Public IPv4

VÃ­ dá»¥:  My Public IPv4: 104.28.160.165

---------------------------------------------

## ğŸ› ï¸ BÆ°á»›c 2: Sá»­a file `.env`

Thay tháº¿ toÃ n bá»™ `EXTERNAL_IP`, `RELAY_IP` vÃ  `ALLOWED_PEER_IP` báº±ng Public IPv4 vá»«a tÃ¬m Ä‘Æ°á»£c
```conf (vÃ­ dá»¥)
EXTERNAL_IP=104.28.160.165
RELAY_IP=104.28.160.165
ALLOWED_PEER_IP=104.28.160.165
```

- âš ï¸ ÄÃ¢y lÃ  IP Public tháº­t tá»« VPS
- âš ï¸ VPS thÆ°á»ng sáº½ má»Ÿ táº¥t cáº£ cÃ¡c cá»•ng nÃªn khÃ´ng cáº§n thay Ä‘á»•i `SERVER_PORT`, `SERVER_PORT` trong .env
---------------------------------------------

## BÆ°á»›c 3: ğŸš€ CÃ¡c bÆ°á»›c cÃ²n láº¡i:
Thá»±c hiá»‡n **giá»‘ng nhÆ° hÆ°á»›ng dáº«n local**, chá»‰ thay IP lÃ  IP public VPS.
